# 知识库系统操作手册

## 📋 目录
1. [系统概述](#系统概述)
2. [日常操作流程](#日常操作流程)
3. [定期维护任务](#定期维护任务)
4. [数据导入指南](#数据导入指南)
5. [故障排除](#故障排除)
6. [下一步计划](#下一步计划)

## 🎯 系统概述

### 系统目标
制造业客户管理知识库系统，通过"联系邮箱 + 公司名称"核心标识实现精准客户管理。

### 核心价值
- **数据标准化**: 统一的客户识别和分类体系
- **自动化处理**: 智能数据导入和分类
- **质量保证**: 完善的数据验证和备份机制
- **分析支持**: 为业务分析提供高质量数据基础

## 🔄 日常操作流程

### 每日操作 (Daily)

#### 1. 系统启动检查
```bash
# 进入项目目录
cd "/Users/gavin/Knowledge base"

# 检查系统状态
python3 query_overview.py
```

**检查项目**:
- 数据库连接正常
- 数据量无明显异常
- 系统响应正常

#### 2. 新数据处理
```bash
# 运行数据导入
python3 ingest_customers.py
python3 ingest_drawings.py

# 或使用增强导入管理器
python3 enhanced_ingestion_manager.py
```

**处理步骤**:
1. 检查新增客户文件
2. 处理新增图纸文件
3. 验证导入结果
4. 检查错误日志

#### 3. 数据质量检查
```bash
# 运行数据质量检查
python3 data_quality_check.py
```

**关注指标**:
- 客户邮箱完整性 > 95%
- 文件路径可访问性 > 98%
- 数据关联完整性 > 90%

### 每周操作 (Weekly)

#### 1. 路径稳定性检查
```bash
# 检查文件路径
python3 path_stability_check.py
```

**检查内容**:
- Symlink路径有效性
- 坚果云同步状态
- 文件访问性能

#### 2. 产品分类更新
```bash
# 运行产品分类
python3 product_classification_manager.py
```

**更新内容**:
- 新图纸自动分类
- 分类规则优化
- 分类结果验证

#### 3. 数据库性能优化
```bash
# 运行数据库优化
python3 database_optimizer.py
```

**优化项目**:
- 查询性能分析
- 索引优化建议
- 数据库统计更新

### 每月操作 (Monthly)

#### 1. 完整系统备份
```bash
# 运行完整备份
python3 backup_manager.py --type full --message "月度备份"
```

**备份内容**:
- 数据库完整备份
- 项目文件压缩备份
- Git版本快照
- 备份元数据

#### 2. 数据分析准备
```bash
# 准备分析数据
python3 prepare_analysis.py
```

**分析内容**:
- 客户活跃度分析
- 产品分类统计
- 业务趋势分析

#### 3. 系统维护报告
生成月度维护报告，包含：
- 系统运行状态
- 数据质量指标
- 性能优化结果
- 问题及解决方案

## 📊 数据导入指南

### 客户数据导入

#### 支持文件格式
- **Excel**: .xlsx, .xls
- **CSV**: .csv
- **文本**: .txt

#### 标准字段映射
```
公司名称 -> company_name
联系邮箱 -> contact_email
国家 -> country
语言 -> language
```

#### 导入步骤
1. **文件准备**
   ```bash
   # 将客户文件放入指定目录
   cp customer_data.xlsx ./data/input/customers/
   ```

2. **运行导入**
   ```bash
   python3 ingest_customers.py
   ```

3. **验证结果**
   ```bash
   python3 data_quality_check.py
   ```

### 图纸数据导入

#### 支持文件格式
- **PDF**: .pdf
- **图片**: .jpg, .png, .jpeg
- **CAD**: .dwg, .dxf

#### 自动分类规则
- **紧固件**: 螺丝、螺钉、螺栓、螺母、垫圈
- **家具**: 椅子、桌子、沙发、床、柜子
- **建材**: 钢、瓷砖、涂料、防水、保温

#### 导入步骤
1. **文件扫描**
   ```bash
   # 自动扫描图纸目录
   python3 ingest_drawings.py --scan /path/to/drawings
   ```

2. **客户匹配**
   - 基于文件名智能匹配客户
   - 支持手动指定客户

3. **分类验证**
   ```bash
   # 验证分类结果
   python3 verify_classification.py
   ```

## 🛠️ 故障排除

### 常见问题及解决方案

#### 1. 数据库连接失败
**症状**: `sqlite3.OperationalError: unable to open database file`

**解决方案**:
```bash
# 检查数据库文件
ls -la ./data/db.sqlite

# 检查权限
chmod 644 ./data/db.sqlite

# 如果损坏，从备份恢复
python3 backup_manager.py --restore ./data/backups/latest_backup.sqlite
```

#### 2. 文件路径不可访问
**症状**: `FileNotFoundError` 或路径访问失败

**解决方案**:
```bash
# 检查路径状态
python3 path_stability_check.py

# 重新扫描文件
python3 ingest_drawings.py --rescan

# 手动更新路径
sqlite3 ./data/db.sqlite "UPDATE drawings SET file_path = ? WHERE id = ?"
```

#### 3. 内存使用过高
**症状**: 系统响应缓慢，内存占用高

**解决方案**:
```bash
# 优化数据库
sqlite3 ./data/db.sqlite "VACUUM;"
sqlite3 ./data/db.sqlite "ANALYZE;"

# 清理日志
find ./logs -name "*.log" -mtime +30 -delete

# 清理临时文件
find ./data/processed -name "*" -mtime +7 -delete
```

#### 4. Git版本控制问题
**症状**: Git操作失败或版本冲突

**解决方案**:
```bash
# 检查Git状态
git status

# 解决冲突
git add .
git commit -m "解决冲突"

# 强制推送 (谨慎使用)
git push --force-with-lease
```

### 性能优化建议

#### 1. 数据库优化
- 定期运行 `VACUUM` 和 `ANALYZE`
- 监控查询性能
- 优化复杂查询

#### 2. 文件管理
- 定期清理临时文件
- 压缩历史文件
- 优化文件存储结构

#### 3. 系统监控
- 监控磁盘空间使用
- 监控内存使用情况
- 监控网络连接状态

## 📅 下一步计划

### 短期目标 (1-3个月)

#### 1. 数据质量提升
- **目标**: 客户邮箱有效性达到95%以上
- **行动**:
  - 修复现有无效邮箱格式
  - 建立邮箱验证机制
  - 定期更新客户信息

#### 2. 自动化程度提升
- **目标**: 减少80%的手动数据录入工作
- **行动**:
  - 完善智能识别算法
  - 增加更多文件格式支持
  - 优化客户匹配逻辑

#### 3. 分类准确性优化
- **目标**: 产品分类准确率达到90%以上
- **行动**:
  - 扩展关键词库
  - 增加机器学习分类
  - 建立人工审核机制

### 中期目标 (3-6个月)

#### 1. 业务分析功能
- **目标**: 建立完整的业务分析体系
- **功能**:
  - 客户价值分析
  - 产品趋势分析
  - 销售预测模型

#### 2. 集成外部系统
- **目标**: 与业务系统无缝集成
- **集成**:
  - ERP系统对接
  - 邮件系统集成
  - 文件管理系统集成

#### 3. 移动端支持
- **目标**: 支持移动设备访问
- **功能**:
  - 移动端查询界面
  - 移动端数据录入
  - 离线数据同步

### 长期目标 (6-12个月)

#### 1. 智能化升级
- **目标**: AI驱动的智能知识库
- **功能**:
  - 智能客户推荐
  - 自动报价生成
  - 智能需求预测

#### 2. 数据资产化
- **目标**: 将数据转化为业务资产
- **价值**:
  - 数据驱动的决策支持
  - 精准营销能力
  - 竞争优势建立

#### 3. 平台化发展
- **目标**: 构建行业知识库平台
- **扩展**:
  - 多租户支持
  - API开放平台
  - 生态系统建设

## 📋 操作检查清单

### 每日检查清单
- [ ] 系统状态正常
- [ ] 新数据已导入
- [ ] 错误日志已检查
- [ ] 备份状态正常

### 每周检查清单
- [ ] 路径稳定性检查
- [ ] 产品分类更新
- [ ] 数据库性能优化
- [ ] 数据质量报告生成

### 每月检查清单
- [ ] 完整系统备份
- [ ] 月度分析报告
- [ ] 系统维护文档更新
- [ ] 下月计划制定

## 📞 技术支持

### 联系方式
- **系统管理员**: [管理员联系方式]
- **技术支持**: [技术支持联系方式]
- **文档更新**: [文档维护人员]

### 相关资源
- **系统文档**: `./knowledge_database_overview.md`
- **API文档**: `./docs/api/`
- **用户手册**: `./docs/user_manual/`
- **开发文档**: `./docs/development/`

---

**文档版本**: 1.0
**最后更新**: 2025-11-05
**下次更新**: 2025-12-05
**维护周期**: 每月更新